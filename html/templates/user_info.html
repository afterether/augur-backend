<html>
<head>
	<title>{{.title}}</title>
	<link href="res/main.css" rel="stylesheet">
</head>
<body>
<script src="/res/darktheme.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script>
	function load_data(profit_loss,accum_pl,mkt_addr,date_str,outcome,mkt_descr) {
		var elt
		elt = document.getElementById("usermktinfo")
		elt.style.display="block"
		elt = document.getElementById("fld_profit_loss")
		elt.innerHTML =profit_loss
		elt = document.getElementById("fld_accum_pl")
		elt.innerHTML = accum_pl
		elt = document.getElementById("fld_mkt_addr")
		elt.innerHTML = mkt_addr
		elt = document.getElementById("fld_outcome")
		elt.innerHTML = outcome
		elt = document.getElementById("fld_mkt_descr")
		elt.innerHTML = mkt_descr
		elt = document.getElementById("fld_date")
		elt.innerHTML = date_str
	}
	var open_positions_data = {{.JSOpenPosData}}
	var profit_loss_data = {{.JSPLData}}
</script>
	<h3 class="page_title">User Info for {{.UserInfo.EOAAddrSh}}</h3>
<div class="user_info">
	<table class="user_info">
		<tr>
			<td>Profit/Loss</td>
			<td title="{{.UserInfo.EOAAddr}}">{{.UserInfo.EOAAddrSh}}</td>
		</tr>
		<tr>
			<td>Wallet Contract Address</td>
			<td title="{{.UserInfo.WalletAddr}}">{{.UserInfo.WalletAddrSh}}</td>
		</tr>
		<tr>
			<td>Total Trades</td>
			<td>{{.UserInfo.TotalTrades}}</td>
		</tr>
		<tr>
			<td>Markets Created</td>
			<td>{{.UserInfo.MarketsCreated}}</td>
		</tr>
		<tr>
			<td>Markets Traded</td>
			<td>{{.UserInfo.MarketsTraded}}</td>
		</tr>
		<tr>
			<td>Withdrawal Requests</td>
			<td>{{.UserInfo.WithdrawReqs}}</td>
		</tr>
		<tr>
			<td>Deposit Requests</td>
			<td>{{.UserInfo.DepositReqs}}</td>
		</tr>
		<tr>
			<td>Total Reports</td>
			<td>{{.UserInfo.TotalReports}}</td>
		</tr>
		<tr>
			<td>Total Reports as Designated Reporter</td>
			<td>{{.UserInfo.TotalDesignated}}</td>
		</tr>
		<tr>
			<td>Profit/Loss</td>
			<td>{{.UserInfo.ProfitLoss}}</td>
		</tr>
		<tr>
			<td>Profit in Affiliate Commissions</td>
			<td>{{.UserInfo.AffProfits}}</td>
		</tr>
		<tr>
			<td>Money At Stake</td>
			<td>{{.UserInfo.MoneyAtStake}}</td>
		</tr>
		<tr>
			<td>Total Deposited</td>
			<td>{{.UserInfo.TotalDeposited}}</td>
		</tr>
		<tr>
			<td>Total Withdrawn</td>
			<td>{{.UserInfo.TotalWithdrawn}}</td>
		</tr>
	</table>
	<br/>
</div>
Account's Open Positions:<br/><br/>
<div id="open_positions_chart"></div>
<br/><br/>
User Profit/Loss history:<br/><br/>
<div id="profit_loss_chart"></div>
<div id="usermktinfo" style="display: none;">
	Profit Loss details:
	<table>
		<tr>
			<td>Profit/Loss in this trade</td>
			<td><span id="fld_profit_loss"></span></td>
		</tr>
		<tr>
			<td>Accumulated Profit/Loss</td>
			<td><span id="fld_accum_pl"></span></td>
		</tr>
		<tr>
			<td>Market Address</td>
			<td><span id="fld_mkt_addr"></span></td>
		</tr>
		<tr>
			<td>Outcome</td>
			<td><span id="fld_outcome"></span></td>
		</tr>
		<tr>
			<td>Market Description</td>
			<td><span id="fld_mkt_descr"></span></td>
		</tr>
		<tr>
			<td>Date:</td>
			<td><span id="fld_date"></span></td>
		</tr>
	</table>
</div>
<script>
// font loading begins
	Highcharts.createElement('link', {
  href: 'https://fonts.googleapis.com/css?family=Unica+One',
  rel: 'stylesheet',
  type: 'text/css'
}, null, document.getElementsByTagName('head')[0]);
// font loading ends
// Apply the theme
set_dark_theme()

// begin of chart container setup
Highcharts.chart('profit_loss_chart', {

	title: {
		text: 'Profit/Loss History'
	},

	subtitle: {
		text: 'Profit/Loss History Detail'
	},

	yAxis: {
		title: {
			text: 'Profit/Loss'
		}
	},

	xAxis: {
//		max: 1.0,
//		min: 0,
		accessibility: {
			rangeDescription: 'Profit/Loss for the period'
		}
	},

	legend: {
		layout: 'vertical',
		align: 'right',
		verticalAlign: 'middle'
	},

	plotOptions: {
		series: {
			label: {
				connectorAllowed: false
			},
			pointStart: 0
		}
	},

	series: [{
		name: 'Profit/Loss',
		point: {
			events: {
				click: function() {this.click.call()}
			}
		},
		data: profit_loss_data
	}],

	responsive: {
		rules: [{
			condition: {
				maxWidth: 500
			},
			chartOptions: {
				legend: {
				layout: 'horizontal',
					align: 'center',
					verticalAlign: 'bottom'
				}
			}
		}]
	},
	tooltip: {
		formatter: function() {
			tooltip ="<div>Profit/Loss: "+this.point.pl+ "<br/>Date: "+this.point.date+"</div>"
			 return tooltip;
		}
	},
});
Highcharts.chart('open_positions_chart', {

	title: {
		text: 'Open Positions'
	},

	subtitle: {
		text: 'Open Positions Detail'
	},

	yAxis: {
		title: {
			text: 'Frozen Funds'
		}
	},

	xAxis: {
//		max: 1.0,
//		min: 0,
		accessibility: {
			rangeDescription: 'Frozen funds for the period'
		}
	},

	legend: {
		layout: 'vertical',
		align: 'right',
		verticalAlign: 'middle'
	},

	plotOptions: {
		series: {
			label: {
				connectorAllowed: false
			},
			pointStart: 0
		}
	},

	series: [{
		name: 'Frozen Funds',
		point: {
			events: {
				click: function() {this.click.call()}
			}
		},
		data: open_positions_data
	}],

	responsive: {
		rules: [{
			condition: {
				maxWidth: 500
			},
			chartOptions: {
				legend: {
				layout: 'horizontal',
					align: 'center',
					verticalAlign: 'bottom'
				}
			}
		}]
	},
	tooltip: {
		formatter: function() {
			tooltip ="<div>Frozen Funds: "+this.point.pl+ "<br/>Date: "+this.point.date+"</div>"
			 return tooltip;
		}
	},
});
</script>
<nav>
	<ul>
	<li>
		<a class="btn_link" href="/index.html">Back</a>
		<span></span><span></span><span></span><span></span>
	</li>
</ul>
</nav>
</body>
</html>
